<Window x:Class="Servy.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:Servy"
        xmlns:resx="clr-namespace:Servy.Resources"
        xmlns:viewmodels="clr-namespace:Servy.ViewModels"
        xmlns:converters="clr-namespace:Servy.Converters"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        Title="Servy"
        MinWidth="600"
        SizeToContent="WidthAndHeight"
        ResizeMode="CanMinimize"
        d:DataContext="{d:DesignInstance Type=viewmodels:MainViewModel, IsDesignTimeCreatable=True}">
    <Window.Resources>
        <converters:InverseBooleanConverter x:Key="InverseBooleanConverter" />
    </Window.Resources>
    <DockPanel>

        <Grid>
            <Grid.RowDefinitions>
                <!-- Tabs -->
                <RowDefinition Height="*" />
                <!-- Action Buttons -->
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>


            <TabControl Grid.Row="0">
                <!-- Main tab UI -->
                <TabItem Header="{x:Static resx:Strings.Label_MainTab}" >
                    <Grid Margin="20" HorizontalAlignment="Center" VerticalAlignment="Top" MinHeight="470">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="300"/>
                            <ColumnDefinition Width="80"/>
                        </Grid.ColumnDefinitions>

                        <!-- Service Name -->
                        <TextBlock Grid.Row="0" Grid.Column="0" Text="{x:Static resx:Strings.Label_ServiceName}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding ServiceName}" Margin="0,5" Grid.ColumnSpan="2"/>

                        <!-- Service Description -->
                        <TextBlock Grid.Row="1" Grid.Column="0" Text="{x:Static resx:Strings.Label_ServiceDescription}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding ServiceDescription}" Margin="0,5" Grid.ColumnSpan="2"/>

                        <!-- Process Path -->
                        <TextBlock Grid.Row="2" Grid.Column="0" Text="{x:Static resx:Strings.Label_ProcessPath}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding ProcessPath}" Margin="0,5"/>
                        <Button Grid.Row="2" Grid.Column="2" Content="{x:Static resx:Strings.Button_Browse}" Command="{Binding BrowseProcessPathCommand}" Margin="5,5,0,5"/>

                        <!-- Startup Directory -->
                        <TextBlock Grid.Row="3" Grid.Column="0" Text="{x:Static resx:Strings.Label_StartupDirectory}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding StartupDirectory}" Margin="0,5"/>
                        <Button Grid.Row="3" Grid.Column="2" Content="{x:Static resx:Strings.Button_Browse}" Command="{Binding BrowseStartupDirectoryCommand}" Margin="5,5,0,5"/>

                        <!-- Process Parameters -->
                        <TextBlock Grid.Row="4" Grid.Column="0" Text="{x:Static resx:Strings.Label_ProcessParameters}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="4" Grid.Column="1" Text="{Binding ProcessParameters}" Margin="0,5" Grid.ColumnSpan="2"/>

                        <!-- Startup Type -->
                        <TextBlock Grid.Row="5" Grid.Column="0" Text="{x:Static resx:Strings.Label_StartupType}" Margin="0,5,10,5"/>
                        <ComboBox Grid.Row="5" 
                                  Grid.Column="1"
                                  ItemsSource="{Binding StartupTypes}"
                                  DisplayMemberPath="DisplayName"
                                  SelectedValue="{Binding SelectedStartupType, Mode=TwoWay}"
                                  SelectedValuePath="StartupType"
                                  Margin="0,5"
                                  Grid.ColumnSpan="2" />

                        <!-- Process Priority -->
                        <TextBlock Grid.Row="6" Grid.Column="0" Text="{x:Static resx:Strings.Label_ProcessPriority}" Margin="0,5,10,5"/>
                        <ComboBox Grid.Row="6" Grid.Column="1"
                                  ItemsSource="{Binding ProcessPriorities}"
                                  DisplayMemberPath="DisplayName"
                                  SelectedValue="{Binding SelectedProcessPriority, Mode=TwoWay}"
                                  SelectedValuePath="Priority"
                                  Margin="0,5"
                                  Grid.ColumnSpan="2" />

                        <!-- Stdout Path -->
                        <TextBlock Grid.Row="7" Grid.Column="0" Text="{x:Static resx:Strings.Label_StdoutPath}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="7" Grid.Column="1" Text="{Binding StdoutPath}" Margin="0,5"/>
                        <Button Grid.Row="7" Grid.Column="2" Content="{x:Static resx:Strings.Button_Browse}" Command="{Binding BrowseStdoutPathCommand}" Margin="5,5,0,5"/>

                        <!-- Stderr Path -->
                        <TextBlock Grid.Row="8" Grid.Column="0" Text="{x:Static resx:Strings.Label_StderrPath}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="8" Grid.Column="1" Text="{Binding StderrPath}" Margin="0,5"/>
                        <Button Grid.Row="8" Grid.Column="2" Content="{x:Static resx:Strings.Button_Browse}" Command="{Binding BrowseStderrPathCommand}" Margin="5,5,0,5"/>

                        <!-- Enable Rotation -->
                        <CheckBox Grid.Row="9" Grid.Column="1"
                                  Content="{x:Static resx:Strings.Label_EnableRotation}"
                                  IsChecked="{Binding EnableRotation}"
                                  Margin="0,5" />

                        <!-- Rotation Size -->
                        <TextBlock Grid.Row="10" Grid.Column="0" Text="{x:Static resx:Strings.Label_RotationSize}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="10" Grid.Column="1" Text="{Binding RotationSize}" Margin="0,5" IsEnabled="{Binding EnableRotation}" />
                        <TextBlock Grid.Row="10" Grid.Column="2" Text="{x:Static resx:Strings.Label_RotationSizeUnity}" VerticalAlignment="Center" Margin="5,5,0,5"/>

                        <!-- Enable Health Monitoring -->
                        <CheckBox Grid.Row="11" 
                                  Grid.Column="1" 
                                  Content="{x:Static resx:Strings.Label_EnableHealthMonitoring}"
                                  IsChecked="{Binding EnableHealthMonitoring}"
                                  Margin="0,5" />

                        <!-- Heartbeat Interval -->
                        <TextBlock Grid.Row="12" Grid.Column="0" Text="{x:Static resx:Strings.Label_HeartbeatInterval}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="12" Grid.Column="1" Text="{Binding HeartbeatInterval}" Margin="0,5" IsEnabled="{Binding EnableHealthMonitoring}"/>
                        <TextBlock Grid.Row="12" Grid.Column="2" Text="{x:Static resx:Strings.Label_Seconds}" VerticalAlignment="Center" Margin="5,5,0,5"/>

                        <!-- Max Failed Checks -->
                        <TextBlock Grid.Row="13" Grid.Column="0" Text="{x:Static resx:Strings.Label_MaxFailedChecks}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="13" Grid.Column="1" Text="{Binding MaxFailedChecks}" Margin="0,5" IsEnabled="{Binding EnableHealthMonitoring}"/>
                        <TextBlock Grid.Row="13" Grid.Column="2" Text="{x:Static resx:Strings.Label_Attempts}" VerticalAlignment="Center" Margin="5,5,0,5"/>

                        <!-- Recovery Action -->
                        <TextBlock Grid.Row="14" Grid.Column="0" Text="{x:Static resx:Strings.Label_RecoveryAction}" Margin="0,5,10,5"/>
                        <ComboBox Grid.Row="14" 
                                  Grid.Column="1"
                                  ItemsSource="{Binding RecoveryActions}"
                                  DisplayMemberPath="DisplayName"
                                  SelectedValue="{Binding SelectedRecoveryAction, Mode=TwoWay}"
                                  SelectedValuePath="RecoveryAction"
                                  Margin="0,5"
                                  IsEnabled="{Binding EnableHealthMonitoring}"
                                  Grid.ColumnSpan="2" />

                        <!-- Max Restart Attempts -->
                        <TextBlock Grid.Row="15" Grid.Column="0" Text="{x:Static resx:Strings.Label_MaxRestartAttempts}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="15" Grid.Column="1" Text="{Binding MaxRestartAttempts}" Margin="0,5" IsEnabled="{Binding EnableHealthMonitoring}"/>
                        <TextBlock Grid.Row="15" Grid.Column="2" Text="{x:Static resx:Strings.Label_Attempts}" VerticalAlignment="Center" Margin="5,5,0,5"/>

                    </Grid>
                </TabItem>

                <!-- Advanced tab UI -->
                <TabItem Header="{x:Static resx:Strings.Label_AdvancedTab}">
                    <Grid Margin="20" HorizontalAlignment="Center" VerticalAlignment="Top" MinHeight="470">
                        <Grid.RowDefinitions>
                            <!-- Env Label -->
                            <RowDefinition Height="Auto"/>
                            <!-- Env Text -->
                            <RowDefinition Height="Auto"/>
                            <!-- Env Info -->
                            <RowDefinition Height="Auto"/>
                            <!-- Dep Label -->
                            <RowDefinition Height="Auto"/>
                            <!-- Dep Text -->
                            <RowDefinition Height="Auto"/>
                            <!-- Dep Info -->
                            <RowDefinition Height="Auto"/>

                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="300"/>
                            <ColumnDefinition Width="80"/>
                        </Grid.ColumnDefinitions>

                        <!-- Environment Variables -->
                        <TextBlock Grid.Row="1" Grid.Column="0" Text="{x:Static resx:Strings.Label_EnvironmentVariables}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding EnvironmentVariables}" Margin="0,5" Grid.ColumnSpan="2" 
AcceptsReturn="True" VerticalScrollBarVisibility="Auto" Height="120" />
                        <TextBlock Grid.Row="2"  Grid.Column="1" Grid.ColumnSpan="2" 
  Text="{x:Static resx:Strings.Info_EnvironmentVariables}" FontStyle="Italic" Foreground="Gray" TextWrapping="Wrap"/>

                        <!-- Service Dependencies -->
                        <TextBlock Grid.Row="3" Grid.Column="0" Text="{x:Static resx:Strings.Label_ServiceDependencies}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding ServiceDependencies}" Margin="0,5" Grid.ColumnSpan="2" 
AcceptsReturn="True" VerticalScrollBarVisibility="Auto" Height="120" />
                        <TextBlock Grid.Row="4"  Grid.Column="1" Grid.ColumnSpan="2" 
  Text="{x:Static resx:Strings.Info_ServiceDependencies}" FontStyle="Italic" Foreground="Gray" TextWrapping="Wrap"/>

                    </Grid>
                </TabItem>

                <!-- Log On tab UI -->
                <TabItem Header="{x:Static resx:Strings.Label_LogOnTab}">
                    <Grid Margin="20" HorizontalAlignment="Center" VerticalAlignment="Top" MinHeight="470">
                        <Grid.RowDefinitions>
                            <!-- Run As Local System RadioButton -->
                            <RowDefinition Height="Auto"/>
                            <!-- User Account RadioButton -->
                            <RowDefinition Height="Auto"/>
                            <!-- User Account Info TextBlock -->
                            <RowDefinition Height="Auto"/>
                            <!-- Password Label + PasswordBox -->
                            <RowDefinition Height="Auto"/>
                            <!-- Confirm Password Label + PasswordBox -->
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="150"/>
                            <ColumnDefinition Width="250"/>
                        </Grid.ColumnDefinitions>

                        <!-- Run As Local System (spans both columns) -->
                        <RadioButton Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,0,0,10"
                 Content="{x:Static resx:Strings.Label_RunAsLocalSystem}" 
                 IsChecked="{Binding RunAsLocalSystem, Mode=TwoWay}" />

                        <!-- User Account RadioButton label in first column -->
                        <RadioButton Grid.Row="1" Grid.Column="0"
                 Content="{x:Static resx:Strings.Label_UserAccount}"
                 IsChecked="{Binding RunAsLocalSystem, Mode=TwoWay, Converter={StaticResource InverseBooleanConverter}}" />

                        <!-- User Account TextBox in second column -->
                        <TextBox Grid.Row="1" Grid.Column="1" 
             Text="{Binding UserAccount, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
             Margin="0,0,0,5"
             IsEnabled="{Binding RunAsLocalSystem, Converter={StaticResource InverseBooleanConverter}}" />

                        <!-- User Account Info TextBlock spanning both columns -->
                        <TextBlock Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2"
               Text="{x:Static resx:Strings.Info_UserAccount}" 
               FontStyle="Italic" Foreground="Gray" TextWrapping="Wrap" Margin="0,0,0,10"/>

                        <!-- Password Label in first column -->
                        <TextBlock Grid.Row="3" Grid.Column="0" 
               Text="{x:Static resx:Strings.Label_Password}" Margin="0,5,10,5" VerticalAlignment="Center"/>

                        <!-- PasswordBox in second column -->
                        <PasswordBox Grid.Row="3" Grid.Column="1" 
                 Margin="0,0,0,10"
                 IsEnabled="{Binding RunAsLocalSystem, Converter={StaticResource InverseBooleanConverter}}"
                 PasswordChanged="PasswordBox_PasswordChanged"/>

                        <!-- Confirm Password Label in first column -->
                        <TextBlock Grid.Row="4" Grid.Column="0" 
               Text="{x:Static resx:Strings.Label_ConfirmPassword}" Margin="0,5,10,5" VerticalAlignment="Center"/>

                        <!-- Confirm PasswordBox in second column -->
                        <PasswordBox Grid.Row="4" Grid.Column="1" 
                 Margin="0,0,0,10"
                 IsEnabled="{Binding RunAsLocalSystem, Converter={StaticResource InverseBooleanConverter}}"
                 PasswordChanged="ConfirmPasswordBox_PasswordChanged"/>
                    </Grid>
                </TabItem>

                <!-- Pre-Launch tab UI -->
                <TabItem Header="{x:Static resx:Strings.Label_PreLaunchTab}" >
                    <Grid Margin="20" HorizontalAlignment="Center" VerticalAlignment="Top" MinHeight="470">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="300"/>
                            <ColumnDefinition Width="80"/>
                        </Grid.ColumnDefinitions>

                        <!-- Info -->
                        <TextBlock Grid.Row="0"  Grid.Column="1" Grid.ColumnSpan="3" Text="{x:Static resx:Strings.Info_PreLaunch}" FontStyle="Normal" Foreground="Black" TextWrapping="Wrap" Margin="5,0,0,5"/>
                        
                        <!-- Process Path -->
                        <TextBlock Grid.Row="1" Grid.Column="0" Text="{x:Static resx:Strings.Label_ProcessPath}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding PreLaunchExecutablePath}" Margin="0,5"/>
                        <Button Grid.Row="1" Grid.Column="2" Content="{x:Static resx:Strings.Button_Browse}" Command="{Binding BrowsePreLaunchProcessPathCommand}" Margin="5,5,0,5"/>

                        <!-- Startup Directory -->
                        <TextBlock Grid.Row="2" Grid.Column="0" Text="{x:Static resx:Strings.Label_StartupDirectory}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding PreLaunchStartupDirectory}" Margin="0,5"/>
                        <Button Grid.Row="2" Grid.Column="2" Content="{x:Static resx:Strings.Button_Browse}" Command="{Binding BrowsePreLaunchStartupDirectoryCommand}" Margin="5,5,0,5"/>

                        <!-- Process Parameters -->
                        <TextBlock Grid.Row="3" Grid.Column="0" Text="{x:Static resx:Strings.Label_ProcessParameters}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding PreLaunchParameters}" Margin="0,5" Grid.ColumnSpan="2"/>

                        <!-- Environment Variables -->
                        <TextBlock Grid.Row="4" Grid.Column="0" Text="{x:Static resx:Strings.Label_EnvironmentVariables}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="4" Grid.Column="1" Text="{Binding PreLaunchEnvironmentVariables}" Margin="0,5" Grid.ColumnSpan="2" 
                                 AcceptsReturn="True" VerticalScrollBarVisibility="Auto" Height="100" />
                        <TextBlock Grid.Row="5"  Grid.Column="1" Grid.ColumnSpan="2" Text="{x:Static resx:Strings.Info_EnvironmentVariables}" FontStyle="Italic" Foreground="Gray" TextWrapping="Wrap"/>

                        <!-- Stdout Path -->
                        <TextBlock Grid.Row="6" Grid.Column="0" Text="{x:Static resx:Strings.Label_StdoutPath}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="6" Grid.Column="1" Text="{Binding PreLaunchStdoutPath}" Margin="0,5"/>
                        <Button Grid.Row="6" Grid.Column="2" Content="{x:Static resx:Strings.Button_Browse}" Command="{Binding BrowsePreLaunchStdoutPathCommand}" Margin="5,5,0,5"/>

                        <!-- Stderr Path -->
                        <TextBlock Grid.Row="7" Grid.Column="0" Text="{x:Static resx:Strings.Label_StderrPath}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="7" Grid.Column="1" Text="{Binding PreLaunchStderrPath}" Margin="0,5"/>
                        <Button Grid.Row="7" Grid.Column="2" Content="{x:Static resx:Strings.Button_Browse}" Command="{Binding BrowsePreLaunchStderrPathCommand}" Margin="5,5,0,5"/>

                        <!-- Timeout -->
                        <TextBlock Grid.Row="8" Grid.Column="0" Text="{x:Static resx:Strings.Label_PreLaunchTimeoutSeconds}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="8" Grid.Column="1" Text="{Binding PreLaunchTimeoutSeconds}" Margin="0,5" Grid.ColumnSpan="2"/>

                        <!-- Retry Attempts -->
                        <TextBlock Grid.Row="9" Grid.Column="0" Text="{x:Static resx:Strings.Label_PreLaunchRetryAttempts}" Margin="0,5,10,5"/>
                        <TextBox Grid.Row="9" Grid.Column="1" Text="{Binding PreLaunchRetryAttempts}" Margin="0,5" Grid.ColumnSpan="2"/>

                        <!-- Ignore Failure -->
                        <CheckBox Grid.Row="10" Grid.Column="1"
                          Content="{x:Static resx:Strings.Label_PreLaunchIgnoreFailure}"
                          IsChecked="{Binding PreLaunchIgnoreFailure}"
                          Margin="0,5" />

                    </Grid>
                </TabItem>

            </TabControl>

            <!-- Bottom Buttons Row -->
            <Grid Grid.Row="1" Margin="0,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <!-- Left side for note -->
                    <ColumnDefinition Width="Auto"/>
                    <!-- Buttons -->
                </Grid.ColumnDefinitions>

                <!-- Footer Note -->
                <TextBlock Grid.Column="0"
                           Text="{x:Static resx:Strings.Label_RequiredFields}"
                           FontStyle="Italic"
                           Foreground="Gray"
                           VerticalAlignment="Center"
                           Margin="10,0,0,0"/>

                <!-- Buttons -->
                <UniformGrid Grid.Column="1" Rows="1" Columns="5" Margin="0,0,10,0">
                    <Button Content="{x:Static resx:Strings.Button_Install}" Width="80" Margin="5" Command="{Binding InstallCommand}" />
                    <Button Content="{x:Static resx:Strings.Button_Uninstall}" Width="80" Margin="5" Command="{Binding UninstallCommand}"/>
                    <Button Content="{x:Static resx:Strings.Button_Start}" Width="80" Margin="5" Command="{Binding StartCommand}"/>
                    <Button Content="{x:Static resx:Strings.Button_Stop}" Width="80" Margin="5" Command="{Binding StopCommand}"/>
                    <Button Content="{x:Static resx:Strings.Button_Restart}" Width="80" Margin="5" Command="{Binding RestartCommand}"/>
                </UniformGrid>
            </Grid>

        </Grid>

    </DockPanel>
</Window>
